# –ü–æ–ª–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

## üîç –ü—Ä–æ–±–ª–µ–º–∞:

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–ª –æ—à–∏–±–∫—É 403 "Token is invalid or expired" –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ–∑–¥–∞—Ç—å —Ä–∞—Å—Ö–æ–¥—ã, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫:
- –†–∞—Å—Ö–æ–¥—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ü–æ—è–≤–ª—è–ª–æ—Å—å —Å–æ–æ–±—â–µ–Ω–∏–µ "–†–∞—Å—Ö–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ"
- –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏

## üîß –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–µ–º–æ —Ç–æ–∫–µ–Ω—ã** - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ–∫–µ–Ω—ã —Ç–∏–ø–∞ `demo_token`, `demo_driver_token`
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `/auth/token/` –≤–º–µ—Å—Ç–æ `/v1/auth/token/`
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö** –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
4. **–ù–µ –ø–æ–ª—É—á–∞–ª–∏—Å—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### 1. **–°–æ–∑–¥–∞–Ω—ã —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**

```bash
# –°–æ–∑–¥–∞–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø—Ä–æ—Å—Ç—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- yunus / 123 (—Ä–æ–ª—å: DRIVER)
- arman / 123 (—Ä–æ–ª—å: DRIVER)  
- dispatcher / 123 (—Ä–æ–ª—å: DISPATCHER)
```

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω URL –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**

**–ë–´–õ–û:**
```dart
final result = await safeRequest('/auth/token/', ...);
```

**–°–¢–ê–õ–û:**
```dart
final result = await safeRequest('/v1/auth/token/', ...);
```

### 3. **–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

```dart
// –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
final userResult = await safeRequest('/v1/users/me/', headers: {
  'Authorization': 'Bearer $token',
});

if (userResult['success'] && userResult['data'] != null) {
  final userData = userResult['data'];
  final userRole = userData['role'] ?? 'DRIVER';
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  await prefs.setString('user_role', userRole);
  await prefs.setString('user_name', username);
  await prefs.setString('user_profile', jsonEncode(userData));
}
```

### 4. **–£–±—Ä–∞–Ω—ã –≤—Å–µ –¥–µ–º–æ —Ç–æ–∫–µ–Ω—ã**

–¢–µ–ø–µ—Ä—å –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—É—é JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### **–®–∞–≥–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

1. **–û—á–∏—Å—Ç–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**
   - –í—ã–π–¥–∏—Ç–µ –∏–∑ —Å–∏—Å—Ç–µ–º—ã –≤ –æ–±–æ–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö
   - –ò–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å —ç–º—É–ª—è—Ç–æ—Ä–æ–≤

2. **–í–æ–π–¥–∏—Ç–µ –∑–∞–Ω–æ–≤–æ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:**
   - `yunus / 123` (–≤–æ–¥–∏—Ç–µ–ª—å)
   - `arman / 123` (–≤–æ–¥–∏—Ç–µ–ª—å)
   - `dispatcher / 123` (–¥–∏—Å–ø–µ—Ç—á–µ—Ä)

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª "–†–∞—Å—Ö–æ–¥—ã"
   - –ù–∞–∂–º–∏—Ç–µ "+" –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ä–∞—Å—Ö–æ–¥–∞
   - –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ
   - –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "–†–∞—Å—Ö–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω" (–ù–ï "–¥–æ–±–∞–≤–ª–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ")

### **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

- ‚úÖ **–ù–µ—Ç –æ—à–∏–±–∫–∏ 403** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤
- ‚úÖ **–ù–µ—Ç –æ—à–∏–±–∫–∏ "Token is invalid or expired"**
- ‚úÖ **–†–∞—Å—Ö–æ–¥—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–î–∏–∑–∞–π–Ω** –æ—Å—Ç–∞–µ—Ç—Å—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–º

## üì± –°—Ç–∞—Ç—É—Å –∑–∞–ø—É—Å–∫–∞:

- ‚úÖ **Django —Å–µ—Ä–≤–µ—Ä:** –ó–∞–ø—É—â–µ–Ω (http://localhost:8000)
- ‚úÖ **Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** –ó–∞–ø—É—â–µ–Ω–æ (emulator-5554)
- ‚úÖ **iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** –ó–∞–ø—É—â–µ–Ω–æ (350BB8E1-7D11-42D8-9F31-E1E1C38A9957)

## üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ API:

### **JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```bash
curl -X POST http://localhost:8000/api/v1/auth/token/ \
  -H "Content-Type: application/json" \
  -d '{"username": "yunus", "password": "123"}'
```

### **–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```bash
curl -H "Authorization: Bearer <token>" \
  http://localhost:8000/api/v1/users/me/
```

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç:

**–í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!**

- ‚úÖ –†–µ–∞–ª—å–Ω–∞—è JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ API
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ URL —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –†–∞—Å—Ö–æ–¥—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≥–æ—Ç–æ–≤—ã –∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ

## üìã –°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | –ü–∞—Ä–æ–ª—å | –†–æ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------------|--------|------|----------|
| yunus | 123 | DRIVER | –í–æ–¥–∏—Ç–µ–ª—å |
| arman | 123 | DRIVER | –í–æ–¥–∏—Ç–µ–ª—å |
| dispatcher | 123 | DISPATCHER | –î–∏—Å–ø–µ—Ç—á–µ—Ä |
| admin | admin | SUPERADMIN | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä | 